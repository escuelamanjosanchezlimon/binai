<div class="titulo-container">
  <h2 (click)="generarNuevaRutina()">Hábitos</h2>
  <div></div>
</div>

<div class="form-row" [formGroup]="form">
  <mat-form-field class="full-width">
    <mat-label>Descripción</mat-label>
    <input formControlName="descripcion" matInput placeholder="Descripción breve..." />
  </mat-form-field>

  <mat-form-field>
    <mat-label>Categoría </mat-label>
    <mat-select formControlName="categoria">
      @for (categoria of categorias; track categoria) {
      <mat-option [value]="categoria.id">
        {{ categoria.label }}
      </mat-option>
      }
    </mat-select>
  </mat-form-field>

  <mat-form-field>
    <mat-label>Tipo </mat-label>
    <mat-select formControlName="tipo">
      @for (tipo of tipos; track tipo.id) {
      <mat-option [value]="tipo.id">
        {{ tipo.label }}
      </mat-option>
      }
    </mat-select>
  </mat-form-field>

  <mat-form-field>
    <mat-label>Estados </mat-label>
    <mat-select formControlName="estado">
      @for (estado of estados; track estado) {
      <mat-option [value]="estado.id">
        {{ estado.label }}
      </mat-option>
      }
    </mat-select>
  </mat-form-field>
</div>

<div class="button-container">
  @if(modo === 'ACTUALIZAR'){

  <button (click)="eliminar()" class="button-delete" mat-icon-button>
    <mat-icon>delete</mat-icon>
  </button>

  <button (click)="cancelar()" class="button-cancel" mat-button>Cancelar</button>
  <button (click)="actualizar()" [disabled]="form.invalid" class="button-add" mat-button>
    <mat-icon>add</mat-icon>
    ACTUALIZAR
  </button>
  }@else{
  <button (click)="registrarHabito()" [disabled]="form.invalid" class="button-add" mat-button>
    <mat-icon>add</mat-icon>AGREGAR
  </button>
  }
</div>

<div class="tabla-container">
  <mat-chip-listbox aria-label="Selección">
    <mat-chip-option (click)="filtrarPorEstado(1)" class="chip-filtro">
      Hoy (Activos)
    </mat-chip-option>
    <mat-chip-option (click)="ordenarPersonalizado()" class="chip-filtro">
      Ordenar
    </mat-chip-option>
    <mat-chip-option (click)="filtrarPorEstado()" class="chip-filtro"> Todos </mat-chip-option>

    <mat-chip-option (click)="filtrarPorCategoria(1)" class="chip-filtro">
      Comidas
    </mat-chip-option>
    <mat-chip-option (click)="filtrarPorCategoria(2)" class="chip-filtro"> Ocio </mat-chip-option>

    <mat-chip-option (click)="filtrarPorEstado(2)" class="chip-filtro"> Inactivos </mat-chip-option>
  </mat-chip-listbox>
  <table mat-table class="tabla-habitos" mat-table [dataSource]="dataSource">
    <!-- Descripción -->

    <ng-container matColumnDef="categoria">
      <th mat-header-cell *matHeaderCellDef>Categoría</th>
      <td mat-cell *matCellDef="let element">
        {{ getCategoriaLabel(element.categoria) }}
      </td>
    </ng-container>

    <ng-container matColumnDef="tipo">
      <th mat-header-cell *matHeaderCellDef>Tipo</th>
      <td mat-cell *matCellDef="let element">
        {{ getTipoLabel(element.tipo) }}
      </td>
    </ng-container>

    <ng-container matColumnDef="descripcion">
      <th mat-header-cell *matHeaderCellDef>Descripción</th>
      <td mat-cell *matCellDef="let element">
        {{ element.descripcion }}
      </td>
    </ng-container>

    <ng-container matColumnDef="estado">
      <th mat-header-cell *matHeaderCellDef>Estado</th>
      <td mat-cell *matCellDef="let element">
        @if(element.estado ===1){
        <span style="color: rgb(24, 127, 24); font-weight: bold">ACTIVO</span>
        }@else {
        <span style="color: rgb(178, 0, 0); font-weight: bold">INACTIVO</span>
        }
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr (click)="mostrar(row)" mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>
  <mat-paginator [pageSizeOptions]="[10, 5, 20]" showFirstLastButtons> </mat-paginator>
</div>
